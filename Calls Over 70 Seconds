insert into custom.bse_big_table (
cust_action_id
, fan_id
, salesforce_contact_id
, action_email
, action_phone
, cust_action_source_system
, cust_action_date
, cust_action_category
, cust_Action
, property
, season
, product_name
, campaign_name
, "section"
, "row" 
, access_level
, fiscal_year
, action_quantity
)
select 
	t.id as "cust_action_id"
	,a.archtics_id__pc as "fan_id"
	,t.accountid as "salesforce_contact_id"
	, a.email__c as "action_email"
	, a.phone as "action_phone"
	, 'Salesforce' as "cust_action_source_system"
	, t.date_completed__c as "cust_action_date"
	, t.calltype as "cust_action_category"
	, 'Call Over 70 Seconds' as "cust_action"
	, o.franchise__c as "property"
	,o.season__c as "season"
	, o.product__c as "product"
	, c.name as "campaign_name"
	, o.section__c as "section"
	, o.row__c as "row"
	, o.access_levell__c as "access_level"
	, CASE
    WHEN EXTRACT(MONTH FROM t.date_completed__c) >= 7 THEN
        CONCAT(
            (EXTRACT(YEAR FROM t.date_completed__c))::int,
            '-',
            (EXTRACT(YEAR FROM t.date_completed__c))::int + 1
        )
    ELSE
        CONCAT(
            (EXTRACT(YEAR FROM t.date_completed__c))::int - 1,
            '-',
            (EXTRACT(YEAR FROM t.date_completed__c))::int
        )
END AS "fiscal_year"
	, 1 as "action_quantity"
from sfsc.task t 
left join sfsc.account a
 	on a.id = t.accountid 
left join sfsc.opportunity o
	on o.id = t.whatid
left join sfsc.campaign c
	on c.id = o.campaignid
where t.calldurationinseconds >= 70
